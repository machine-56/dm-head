{% extends 'dmhead/dmheadsidebar.html' %}
{% load static %}
{% block title %}Verify Leads{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'dm_head/css/common.css' %}">
<link rel="stylesheet" href="{% static 'dm_head/css/head_leads.css' %}">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<div class="container mt-4 comn_table_bg">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h5 class="text-white mb-0">Unverified Leads</h5>
    <div class="d-flex gap-2">
      <button class="btn btn-outline-info btn-sm" id="printBtn">ðŸ–¨ Print</button>
      <button class="btn btn-outline-light btn-sm" id="pdfBtn">ðŸ“„ PDF</button>
      <a href="" class="btn btn-outline-success btn-sm">ðŸ“¥ Excel</a>
    </div>
  </div>

  <div class="row g-2 mb-3">
    <div class="col-md-2">
      <select class="form-select" id="filterStatus">
        <option value="0" selected>Unverified</option>
        <option value="1">Verified</option>
        <option value="waste">Wasted</option>
        <option value="incomplete">Incomplete</option>
      </select>
    </div>
    <div class="col-md-2">
      <select class="form-select" id="filterEmployee">
        <option value="">Employee</option>
        {% for emp in employees %}
        <option value="{{ emp.id }}">{{ emp.name }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="col-md-2">
      <input type="date" class="form-control" id="filterStart">
    </div>
    <div class="col-md-2">
      <input type="date" class="form-control" id="filterEnd">
    </div>
    <div class="col-md-2">
      <select class="form-select" id="maxRows">
        <option value="10">10 rows</option>
        <option value="20">20 rows</option>
        <option value="50">50 rows</option>
        <option value="100">100 rows</option>
      </select>
    </div>
    <div class="col-md-2">
      <input type="text" class="form-control" id="searchInput" placeholder="Search...">
    </div>
  </div>

  <div class="d-flex justify-content-between align-items-center mb-2">
    <div>
      <select id="actionSelect" class="form-select form-select-sm d-inline-block w-auto">
        <option selected disabled>Choose Action</option>
        <option value="verify">Verify</option>
        <option value="unverify">Unverify</option>
        <option value="incomplete">Mark Incomplete</option>
        <option value="waste">Mark Waste</option>
        <option value="unwaste">Unmark Waste</option>
        <option value="delete">Delete</option>
      </select>
      <button class="btn btn-outline-warning btn-sm" id="applyAction">âœ” Apply</button>
    </div>
    <div>
      <button class="btn btn-outline-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#dayReportModal">ðŸ“Š Day Report</button>
      <button class="btn btn-outline-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addLeadModal">âž• Add Lead</button>
    </div>
  </div>

  <div class="table-responsive" id="leadTableContainer">
    <table class="table table-dark table-bordered align-middle text-center" id="leadTable">
      <thead>
        <tr>
          <th><input type="checkbox" id="selectAll"></th>
          <th>Collected By</th>
          <th>Name & Source</th>
          <th>Contact</th>
          <th>Status</th>
          <th>[+]</th>
        </tr>
      </thead>
      <tbody>
        {% for lead, extra in leads %}
        <tr>
          <td><input type="checkbox" class="leadCheck" value="{{ lead.id }}"></td>
          <td>{{ lead.collected_by.name }}<br><small>{{ lead.added_date }}</small></td>
          <td>{{ lead.name }}<br><small>{{ lead.source }}</small></td>
          <td>{{ lead.email }}<br>{{ lead.contact }}</td>
          <td>
            {% if lead.waste_data %}<span class="badge bg-danger">Wasted</span>
            {% elif lead.incomplete_status %}<span class="badge bg-warning">Incomplete</span>
            {% elif lead.status %}<span class="badge bg-success">Verified</span>
            {% else %}<span class="badge bg-secondary">Unverified</span>
            {% endif %}
          </td>
          <td><button class="btn btn-outline-info btn-sm show-lead-details" data-id="{{ lead.id }}">+</button></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>


<script src="{% static 'dm_head/js/head_leads.js' %}"></script>
{% endblock %}
